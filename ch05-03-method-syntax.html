<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>方法语法 | Rust 程序设计语言（中文版）</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Rust 程序设计语言">
    
    <link rel="preload" href="/rust/assets/css/0.styles.f783c941.css" as="style"><link rel="preload" href="/rust/assets/js/app.40d541f7.js" as="script"><link rel="preload" href="/rust/assets/js/2.1042d7dd.js" as="script"><link rel="preload" href="/rust/assets/js/42.fee2c385.js" as="script"><link rel="prefetch" href="/rust/assets/js/10.edd33632.js"><link rel="prefetch" href="/rust/assets/js/100.0ad946d0.js"><link rel="prefetch" href="/rust/assets/js/101.dbc25b29.js"><link rel="prefetch" href="/rust/assets/js/102.7ba94d76.js"><link rel="prefetch" href="/rust/assets/js/103.cc288c8b.js"><link rel="prefetch" href="/rust/assets/js/104.1980956e.js"><link rel="prefetch" href="/rust/assets/js/105.e1daab00.js"><link rel="prefetch" href="/rust/assets/js/106.ed531c97.js"><link rel="prefetch" href="/rust/assets/js/107.78455384.js"><link rel="prefetch" href="/rust/assets/js/108.8e93e32c.js"><link rel="prefetch" href="/rust/assets/js/109.19f22757.js"><link rel="prefetch" href="/rust/assets/js/11.376b4060.js"><link rel="prefetch" href="/rust/assets/js/110.095a7d5d.js"><link rel="prefetch" href="/rust/assets/js/111.0ee91128.js"><link rel="prefetch" href="/rust/assets/js/112.5fd8a7df.js"><link rel="prefetch" href="/rust/assets/js/113.885e9290.js"><link rel="prefetch" href="/rust/assets/js/114.87dfcbf6.js"><link rel="prefetch" href="/rust/assets/js/115.def2e060.js"><link rel="prefetch" href="/rust/assets/js/12.64ed3f3e.js"><link rel="prefetch" href="/rust/assets/js/13.0d26ee29.js"><link rel="prefetch" href="/rust/assets/js/14.60415b33.js"><link rel="prefetch" href="/rust/assets/js/15.7242e2c2.js"><link rel="prefetch" href="/rust/assets/js/16.9b5245a7.js"><link rel="prefetch" href="/rust/assets/js/17.b314b75e.js"><link rel="prefetch" href="/rust/assets/js/18.e07affd9.js"><link rel="prefetch" href="/rust/assets/js/19.27b67111.js"><link rel="prefetch" href="/rust/assets/js/20.f62b665f.js"><link rel="prefetch" href="/rust/assets/js/21.b72defa0.js"><link rel="prefetch" href="/rust/assets/js/22.d2a936df.js"><link rel="prefetch" href="/rust/assets/js/23.b9e2d931.js"><link rel="prefetch" href="/rust/assets/js/24.08b7ec27.js"><link rel="prefetch" href="/rust/assets/js/25.9d763c7f.js"><link rel="prefetch" href="/rust/assets/js/26.2cd2cb9b.js"><link rel="prefetch" href="/rust/assets/js/27.cb545e35.js"><link rel="prefetch" href="/rust/assets/js/28.c0a80cea.js"><link rel="prefetch" href="/rust/assets/js/29.dc7aa66e.js"><link rel="prefetch" href="/rust/assets/js/3.0cf71ca5.js"><link rel="prefetch" href="/rust/assets/js/30.4512ed10.js"><link rel="prefetch" href="/rust/assets/js/31.4d15a4d7.js"><link rel="prefetch" href="/rust/assets/js/32.05b1d56d.js"><link rel="prefetch" href="/rust/assets/js/33.ae5a07c5.js"><link rel="prefetch" href="/rust/assets/js/34.116008a1.js"><link rel="prefetch" href="/rust/assets/js/35.5b354269.js"><link rel="prefetch" href="/rust/assets/js/36.f27f2f68.js"><link rel="prefetch" href="/rust/assets/js/37.dba8fc27.js"><link rel="prefetch" href="/rust/assets/js/38.1087c819.js"><link rel="prefetch" href="/rust/assets/js/39.bad10f35.js"><link rel="prefetch" href="/rust/assets/js/4.32b65829.js"><link rel="prefetch" href="/rust/assets/js/40.4695233f.js"><link rel="prefetch" href="/rust/assets/js/41.18e89382.js"><link rel="prefetch" href="/rust/assets/js/43.c4063823.js"><link rel="prefetch" href="/rust/assets/js/44.d093189d.js"><link rel="prefetch" href="/rust/assets/js/45.8eeddd57.js"><link rel="prefetch" href="/rust/assets/js/46.832b5e6a.js"><link rel="prefetch" href="/rust/assets/js/47.9f6416b7.js"><link rel="prefetch" href="/rust/assets/js/48.145f024e.js"><link rel="prefetch" href="/rust/assets/js/49.ade94042.js"><link rel="prefetch" href="/rust/assets/js/5.72ff7d8b.js"><link rel="prefetch" href="/rust/assets/js/50.24344e5b.js"><link rel="prefetch" href="/rust/assets/js/51.0dac9a10.js"><link rel="prefetch" href="/rust/assets/js/52.c8197705.js"><link rel="prefetch" href="/rust/assets/js/53.0b052130.js"><link rel="prefetch" href="/rust/assets/js/54.79733cbf.js"><link rel="prefetch" href="/rust/assets/js/55.a89b7d87.js"><link rel="prefetch" href="/rust/assets/js/56.31966c20.js"><link rel="prefetch" href="/rust/assets/js/57.b86257a0.js"><link rel="prefetch" href="/rust/assets/js/58.0e06d7ab.js"><link rel="prefetch" href="/rust/assets/js/59.cb23df74.js"><link rel="prefetch" href="/rust/assets/js/6.93607226.js"><link rel="prefetch" href="/rust/assets/js/60.56de2678.js"><link rel="prefetch" href="/rust/assets/js/61.ed2571c2.js"><link rel="prefetch" href="/rust/assets/js/62.4978fd70.js"><link rel="prefetch" href="/rust/assets/js/63.e573f90e.js"><link rel="prefetch" href="/rust/assets/js/64.3ac178e7.js"><link rel="prefetch" href="/rust/assets/js/65.d337064e.js"><link rel="prefetch" href="/rust/assets/js/66.96dc0ffe.js"><link rel="prefetch" href="/rust/assets/js/67.aca54fb9.js"><link rel="prefetch" href="/rust/assets/js/68.05029e3a.js"><link rel="prefetch" href="/rust/assets/js/69.044160c7.js"><link rel="prefetch" href="/rust/assets/js/7.d32deb2c.js"><link rel="prefetch" href="/rust/assets/js/70.5454e01d.js"><link rel="prefetch" href="/rust/assets/js/71.e030c5ea.js"><link rel="prefetch" href="/rust/assets/js/72.de7bfec9.js"><link rel="prefetch" href="/rust/assets/js/73.9a2ecbed.js"><link rel="prefetch" href="/rust/assets/js/74.bbd74ab2.js"><link rel="prefetch" href="/rust/assets/js/75.d184f807.js"><link rel="prefetch" href="/rust/assets/js/76.2f2fc478.js"><link rel="prefetch" href="/rust/assets/js/77.838f77db.js"><link rel="prefetch" href="/rust/assets/js/78.846e55b6.js"><link rel="prefetch" href="/rust/assets/js/79.b83fa9ef.js"><link rel="prefetch" href="/rust/assets/js/8.ad267e18.js"><link rel="prefetch" href="/rust/assets/js/80.b9487892.js"><link rel="prefetch" href="/rust/assets/js/81.ee9292a9.js"><link rel="prefetch" href="/rust/assets/js/82.38f08188.js"><link rel="prefetch" href="/rust/assets/js/83.7aaab8c1.js"><link rel="prefetch" href="/rust/assets/js/84.6a0e67e1.js"><link rel="prefetch" href="/rust/assets/js/85.78e6ca4e.js"><link rel="prefetch" href="/rust/assets/js/86.dfb82046.js"><link rel="prefetch" href="/rust/assets/js/87.f4167404.js"><link rel="prefetch" href="/rust/assets/js/88.10371734.js"><link rel="prefetch" href="/rust/assets/js/89.0a01f554.js"><link rel="prefetch" href="/rust/assets/js/9.889f1565.js"><link rel="prefetch" href="/rust/assets/js/90.c126a47e.js"><link rel="prefetch" href="/rust/assets/js/91.53dadb1d.js"><link rel="prefetch" href="/rust/assets/js/92.3549b67d.js"><link rel="prefetch" href="/rust/assets/js/93.51745a2f.js"><link rel="prefetch" href="/rust/assets/js/94.ee0da9e3.js"><link rel="prefetch" href="/rust/assets/js/95.8844f965.js"><link rel="prefetch" href="/rust/assets/js/96.9edaa201.js"><link rel="prefetch" href="/rust/assets/js/97.a5fa6694.js"><link rel="prefetch" href="/rust/assets/js/98.f21e4069.js"><link rel="prefetch" href="/rust/assets/js/99.fde1e50a.js">
    <link rel="stylesheet" href="/rust/assets/css/0.styles.f783c941.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/rust/" class="home-link router-link-active"><!----> <span class="site-name">Rust 程序设计语言（中文版）</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/roojay520/trpl-zh-cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它" class="dropdown-title"><span class="title">其它</span> <span class="arrow down"></span></button> <button type="button" aria-label="其它" class="mobile-dropdown-title"><span class="title">其它</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/rust-lang/book" target="_blank" rel="noopener noreferrer" class="nav-link external">
  The Rust Programming Language
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/KaiserY/trpl-zh-cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Rust 程序设计语言（第二版 &amp; 2018 edition）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://rust.cc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Rust语言中文社区
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/roojay520/trpl-zh-cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它" class="dropdown-title"><span class="title">其它</span> <span class="arrow down"></span></button> <button type="button" aria-label="其它" class="mobile-dropdown-title"><span class="title">其它</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/rust-lang/book" target="_blank" rel="noopener noreferrer" class="nav-link external">
  The Rust Programming Language
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/KaiserY/trpl-zh-cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Rust 程序设计语言（第二版 &amp; 2018 edition）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://rust.cc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Rust语言中文社区
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/rust/" class="sidebar-heading clickable router-link-active open"><span>目录</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>入门指南</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rust/title-page.html" class="sidebar-link">Rust 程序设计语言</a></li><li><a href="/rust/foreword.html" class="sidebar-link">前言</a></li><li><a href="/rust/ch00-00-introduction.html" class="sidebar-link">介绍</a></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/rust/ch01-00-getting-started" class="sidebar-heading clickable"><span>入门指南</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/rust/ch01-01-installation.html" class="sidebar-link">安装</a></li><li><a href="/rust/ch01-02-hello-world.html" class="sidebar-link">Hello, World!</a></li><li><a href="/rust/ch01-03-hello-cargo.html" class="sidebar-link">Hello, Cargo!</a></li><li><a href="/rust/ch02-00-guessing-game-tutorial.html" class="sidebar-link">编写 猜猜看 游戏</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/rust/ch03-00-common-programming-concepts" class="sidebar-heading clickable"><span>常见编程概念</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/rust/ch03-01-variables-and-mutability.html" class="sidebar-link">变量和可变性</a></li><li><a href="/rust/ch03-02-data-types.html" class="sidebar-link">数据类型</a></li><li><a href="/rust/ch03-03-how-functions-work.html" class="sidebar-link">函数</a></li><li><a href="/rust/ch03-04-comments.html" class="sidebar-link">注释</a></li><li><a href="/rust/ch03-05-control-flow.html" class="sidebar-link">控制流</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/rust/ch04-00-understanding-ownership" class="sidebar-heading clickable"><span>认识所有权</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/rust/ch04-01-what-is-ownership.html" class="sidebar-link">什么是所有权？</a></li><li><a href="/rust/ch04-02-references-and-borrowing.html" class="sidebar-link">引用与借用</a></li><li><a href="/rust/ch04-03-slices.html" class="sidebar-link">Slice 类型</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/rust/ch05-00-structs" class="sidebar-heading clickable open"><span>使用结构体来组织相关联的数据</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/rust/ch05-01-defining-structs.html" class="sidebar-link">定义并实例化结构体</a></li><li><a href="/rust/ch05-02-example-structs.html" class="sidebar-link">一个使用结构体的示例程序</a></li><li><a href="/rust/ch05-03-method-syntax.html" aria-current="page" class="active sidebar-link">方法语法</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/rust/ch06-00-enums" class="sidebar-heading clickable"><span>枚举与模式匹配</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/rust/ch06-01-defining-an-enum.html" class="sidebar-link">定义枚举</a></li><li><a href="/rust/ch06-02-match.html" class="sidebar-link">match 控制流运算符</a></li><li><a href="/rust/ch06-03-if-let.html" class="sidebar-link">if let 简单控制流</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>基本 Rust 技能</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Rust 编程思想</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>高级主题</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="方法语法"><a href="#方法语法" class="header-anchor">#</a> 方法语法</h2> <blockquote><p><a href="https://github.com/rust-lang/book/blob/main/src/ch05-03-method-syntax.md" target="_blank" rel="noopener noreferrer">ch05-03-method-syntax.md<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <br>
commit a86c1d315789b3ca13b20d50ad5005c62bdd9e37</p></blockquote> <p><strong>方法</strong> 与函数类似：它们使用 <code>fn</code> 关键字和名称声明，可以拥有参数和返回值，同时包含在某处调用该方法时会执行的代码。不过方法与函数是不同的，因为它们在结构体的上下文中被定义（或者是枚举或 trait 对象的上下文，将分别在第六章和第十七章讲解），并且它们第一个参数总是 <code>self</code>，它代表调用该方法的结构体实例。</p> <h3 id="定义方法"><a href="#定义方法" class="header-anchor">#</a> 定义方法</h3> <p>让我们把前面实现的获取一个 <code>Rectangle</code> 实例作为参数的 <code>area</code> 函数，改写成一个定义于 <code>Rectangle</code> 结构体上的 <code>area</code> 方法，如示例 5-13 所示：</p> <p><span class="filename">文件名: src/main.rs</span></p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Rectangle</span> <span class="token punctuation">{</span>
    width<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">area</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u32</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> rect1 <span class="token operator">=</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">50</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span>
        <span class="token string">&quot;The area of the rectangle is {} square pixels.&quot;</span><span class="token punctuation">,</span>
        rect1<span class="token punctuation">.</span><span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><span class="caption">示例 5-13：在 <code>Rectangle</code> 结构体上定义 <code>area</code> 方法</span></p> <p>为了使函数定义于 <code>Rectangle</code> 的上下文中，我们开始了一个 <code>impl</code> 块（<code>impl</code> 是 <em>implementation</em> 的缩写）。接着将 <code>area</code> 函数移动到 <code>impl</code> 大括号中，并将签名中的第一个（在这里也是唯一一个）参数和函数体中其他地方的对应参数改成 <code>self</code>。然后在 <code>main</code> 中将我们先前调用 <code>area</code> 方法并传递 <code>rect1</code> 作为参数的地方，改成使用 <strong>方法语法</strong>（<em>method syntax</em>）在 <code>Rectangle</code> 实例上调用 <code>area</code> 方法。方法语法获取一个实例并加上一个点号，后跟方法名、圆括号以及任何参数。</p> <p>在 <code>area</code> 的签名中，使用 <code>&amp;self</code> 来替代 <code>rectangle: &amp;Rectangle</code>，因为该方法位于 <code>impl Rectangle</code> 上下文中所以 Rust 知道 <code>self</code> 的类型是 <code>Rectangle</code>。注意仍然需要在 <code>self</code> 前面加上 <code>&amp;</code>，就像 <code>&amp;Rectangle</code> 一样。方法可以选择获取 <code>self</code> 的所有权，或者像我们这里一样不可变地借用 <code>self</code>，或者可变地借用 <code>self</code>，就跟其他参数一样。</p> <p>这里选择 <code>&amp;self</code> 的理由跟在函数版本中使用 <code>&amp;Rectangle</code> 是相同的：我们并不想获取所有权，只希望能够读取结构体中的数据，而不是写入。如果想要在方法中改变调用方法的实例，需要将第一个参数改为 <code>&amp;mut self</code>。通过仅仅使用 <code>self</code> 作为第一个参数来使方法获取实例的所有权是很少见的；这种技术通常用在当方法将 <code>self</code> 转换成别的实例的时候，这时我们想要防止调用者在转换之后使用原始的实例。</p> <p>使用方法替代函数，除了可使用方法语法和不需要在每个函数签名中重复 <code>self</code> 的类型之外，其主要好处在于组织性。我们将某个类型实例能做的所有事情都一起放入 <code>impl</code> 块中，而不是让将来的用户在我们的库中到处寻找 <code>Rectangle</code> 的功能。</p> <blockquote><h3 id="运算符到哪去了"><a href="#运算符到哪去了" class="header-anchor">#</a> <code>-&gt;</code> 运算符到哪去了？</h3> <p>在 C/C++ 语言中，有两个不同的运算符来调用方法：<code>.</code> 直接在对象上调用方法，而 <code>-&gt;</code> 在一个对象的指针上调用方法，这时需要先解引用（dereference）指针。换句话说，如果 <code>object</code> 是一个指针，那么 <code>object-&gt;something()</code> 就像 <code>(*object).something()</code> 一样。</p> <p>Rust 并没有一个与 <code>-&gt;</code> 等效的运算符；相反，Rust 有一个叫 <strong>自动引用和解引用</strong>（<em>automatic referencing and dereferencing</em>）的功能。方法调用是 Rust 中少数几个拥有这种行为的地方。</p> <p>他是这样工作的：当使用 <code>object.something()</code> 调用方法时，Rust 会自动为 <code>object</code> 添加 <code>&amp;</code>、<code>&amp;mut</code> 或 <code>*</code> 以便使 <code>object</code> 与方法签名匹配。也就是说，这些代码是等价的：</p> <div class="language-rust extra-class"><pre class="language-rust"><code># <span class="token attribute attr-name">#[derive(Debug,Copy,Clone)]</span>
# <span class="token keyword">struct</span> <span class="token type-definition class-name">Point</span> <span class="token punctuation">{</span>
#     x<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span>
#     y<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span>
# <span class="token punctuation">}</span>
#
# <span class="token keyword">impl</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
#    <span class="token keyword">fn</span> <span class="token function-definition function">distance</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Point</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">f64</span> <span class="token punctuation">{</span>
#        <span class="token keyword">let</span> x_squared <span class="token operator">=</span> <span class="token keyword">f64</span><span class="token punctuation">::</span><span class="token function">powi</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>x <span class="token operator">-</span> <span class="token keyword">self</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
#        <span class="token keyword">let</span> y_squared <span class="token operator">=</span> <span class="token keyword">f64</span><span class="token punctuation">::</span><span class="token function">powi</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>y <span class="token operator">-</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
#
#        <span class="token keyword">f64</span><span class="token punctuation">::</span><span class="token function">sqrt</span><span class="token punctuation">(</span>x_squared <span class="token operator">+</span> y_squared<span class="token punctuation">)</span>
#    <span class="token punctuation">}</span>
# <span class="token punctuation">}</span>
# <span class="token keyword">let</span> p1 <span class="token operator">=</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0.0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
# <span class="token keyword">let</span> p2 <span class="token operator">=</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">5.0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">6.5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span><span class="token function">distance</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token operator">&amp;</span>p1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">distance</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>第一行看起来简洁的多。这种自动引用的行为之所以有效，是因为方法有一个明确的接收者———— <code>self</code> 的类型。在给出接收者和方法名的前提下，Rust 可以明确地计算出方法是仅仅读取（<code>&amp;self</code>），做出修改（<code>&amp;mut self</code>）或者是获取所有权（<code>self</code>）。事实上，Rust 对方法接收者的隐式借用让所有权在实践中更友好。</p></blockquote> <h3 id="带有更多参数的方法"><a href="#带有更多参数的方法" class="header-anchor">#</a> 带有更多参数的方法</h3> <p>让我们通过实现 <code>Rectangle</code> 结构体上的另一方法来练习使用方法。这回，我们让一个 <code>Rectangle</code> 的实例获取另一个 <code>Rectangle</code> 实例，如果 <code>self</code> 能完全包含第二个长方形则返回 <code>true</code>；否则返回 <code>false</code>。一旦定义了 <code>can_hold</code> 方法，就可以编写示例 5-14 中的代码。</p> <p><span class="filename">文件名: src/main.rs</span></p> <div class="language-rust,ignore extra-class"><pre class="language-text"><code>fn main() {
    let rect1 = Rectangle { width: 30, height: 50 };
    let rect2 = Rectangle { width: 10, height: 40 };
    let rect3 = Rectangle { width: 60, height: 45 };

    println!(&quot;Can rect1 hold rect2? {}&quot;, rect1.can_hold(&amp;rect2));
    println!(&quot;Can rect1 hold rect3? {}&quot;, rect1.can_hold(&amp;rect3));
}
</code></pre></div><p><span class="caption">示例 5-14：使用还未实现的 <code>can_hold</code> 方法</span></p> <p>同时我们希望看到如下输出，因为 <code>rect2</code> 的两个维度都小于 <code>rect1</code>，而 <code>rect3</code> 比 <code>rect1</code> 要宽：</p> <div class="language-text extra-class"><pre class="language-text"><code>Can rect1 hold rect2? true
Can rect1 hold rect3? false
</code></pre></div><p>因为我们想定义一个方法，所以它应该位于 <code>impl Rectangle</code> 块中。方法名是 <code>can_hold</code>，并且它会获取另一个 <code>Rectangle</code> 的不可变借用作为参数。通过观察调用方法的代码可以看出参数是什么类型的：<code>rect1.can_hold(&amp;rect2)</code> 传入了 <code>&amp;rect2</code>，它是一个 <code>Rectangle</code> 的实例 <code>rect2</code> 的不可变借用。这是可以理解的，因为我们只需要读取 <code>rect2</code>（而不是写入，这意味着我们需要一个不可变借用），而且希望 <code>main</code> 保持 <code>rect2</code> 的所有权，这样就可以在调用这个方法后继续使用它。<code>can_hold</code> 的返回值是一个布尔值，其实现会分别检查 <code>self</code> 的宽高是否都大于另一个 <code>Rectangle</code>。让我们在示例 5-13 的 <code>impl</code> 块中增加这个新的 <code>can_hold</code> 方法，如示例 5-15 所示：</p> <p><span class="filename">文件名: src/main.rs</span></p> <div class="language-rust extra-class"><pre class="language-rust"><code># <span class="token attribute attr-name">#[derive(Debug)]</span>
# <span class="token keyword">struct</span> <span class="token type-definition class-name">Rectangle</span> <span class="token punctuation">{</span>
#     width<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
#     height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
# <span class="token punctuation">}</span>
#
<span class="token keyword">impl</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">area</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u32</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">can_hold</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Rectangle</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">&gt;</span> other<span class="token punctuation">.</span>width <span class="token operator">&amp;&amp;</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">&gt;</span> other<span class="token punctuation">.</span>height
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><span class="caption">示例 5-15：在 <code>Rectangle</code> 上实现 <code>can_hold</code> 方法，它获取另一个 <code>Rectangle</code> 实例作为参数</span></p> <p>如果结合示例 5-14 的 <code>main</code> 函数来运行，就会看到期望的输出。在方法签名中，可以在 <code>self</code> 后增加多个参数，而且这些参数就像函数中的参数一样工作。</p> <h3 id="关联函数"><a href="#关联函数" class="header-anchor">#</a> 关联函数</h3> <p><code>impl</code> 块的另一个有用的功能是：允许在 <code>impl</code> 块中定义 <strong>不</strong> 以 <code>self</code> 作为参数的函数。这被称为 <strong>关联函数</strong>（<em>associated functions</em>），因为它们与结构体相关联。它们仍是函数而不是方法，因为它们并不作用于一个结构体的实例。你已经使用过 <code>String::from</code> 关联函数了。</p> <p>关联函数经常被用作返回一个结构体新实例的构造函数。例如我们可以提供一个关联函数，它接受一个维度参数并且同时作为宽和高，这样可以更轻松的创建一个正方形 <code>Rectangle</code> 而不必指定两次同样的值：</p> <p><span class="filename">文件名: src/main.rs</span></p> <div class="language-rust extra-class"><pre class="language-rust"><code># <span class="token attribute attr-name">#[derive(Debug)]</span>
# <span class="token keyword">struct</span> <span class="token type-definition class-name">Rectangle</span> <span class="token punctuation">{</span>
#     width<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
#     height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
# <span class="token punctuation">}</span>
#
<span class="token keyword">impl</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">square</span><span class="token punctuation">(</span>size<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
        <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span> width<span class="token punctuation">:</span> size<span class="token punctuation">,</span> height<span class="token punctuation">:</span> size <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用结构体名和 <code>::</code> 语法来调用这个关联函数：比如 <code>let sq = Rectangle::square(3);</code>。这个方法位于结构体的命名空间中：<code>::</code> 语法用于关联函数和模块创建的命名空间。第七章会讲到模块。</p> <h3 id="多个-impl-块"><a href="#多个-impl-块" class="header-anchor">#</a> 多个 <code>impl</code> 块</h3> <p>每个结构体都允许拥有多个 <code>impl</code> 块。例如，示例 5-16 中的代码等同于示例 5-15，但每个方法有其自己的 <code>impl</code> 块。</p> <div class="language-rust extra-class"><pre class="language-rust"><code># <span class="token attribute attr-name">#[derive(Debug)]</span>
# <span class="token keyword">struct</span> <span class="token type-definition class-name">Rectangle</span> <span class="token punctuation">{</span>
#     width<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
#     height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
# <span class="token punctuation">}</span>
#
<span class="token keyword">impl</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">area</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u32</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">can_hold</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Rectangle</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">&gt;</span> other<span class="token punctuation">.</span>width <span class="token operator">&amp;&amp;</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">&gt;</span> other<span class="token punctuation">.</span>height
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><span class="caption">示例 5-16：使用多个 <code>impl</code> 块重写示例 5-15</span></p> <p>这里没有理由将这些方法分散在多个 <code>impl</code> 块中，不过这是有效的语法。第十章讨论泛型和 trait 时会看到实用的多 <code>impl</code> 块的用例。</p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>结构体让你可以创建出在你的领域中有意义的自定义类型。通过结构体，我们可以将相关联的数据片段联系起来并命名它们，这样可以使得代码更加清晰。方法允许为结构体实例指定行为，而关联函数将特定功能置于结构体的命名空间中并且无需一个实例。</p> <p>但结构体并不是创建自定义类型的唯一方法：让我们转向 Rust 的枚举功能，为你的工具箱再添一个工具。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/15/2021, 1:36:56 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/rust/ch05-02-example-structs.html" class="prev">
        一个使用结构体的示例程序
      </a></span> <span class="next"><a href="/rust/ch06-01-defining-an-enum.html">
        定义枚举
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/rust/assets/js/app.40d541f7.js" defer></script><script src="/rust/assets/js/2.1042d7dd.js" defer></script><script src="/rust/assets/js/42.fee2c385.js" defer></script>
  </body>
</html>
